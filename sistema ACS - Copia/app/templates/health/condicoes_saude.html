{% extends "base.html" %}

{% block title %}Condições de Saúde - Sistema ACS{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card">
                <div class="card-body">
                    <h2 class="card-title text-center mb-4">
                        <i class="fas fa-heartbeat text-primary me-2"></i>
                        Condições/Situações de Saúde
                    </h2>

                    <form method="POST" class="needs-validation" novalidate>
                        {{ form.csrf_token }}
                        
                        <!-- Gestação -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Gestação</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <div class="form-check">
                                            {{ form.gestante(class="form-check-input") }}
                                            {{ form.gestante.label(class="form-check-label") }}
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        {{ form.maternidade_referencia.label(class="form-label") }}
                                        {{ form.maternidade_referencia(class="form-control") }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Peso -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Peso</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    {{ form.peso_auto_referido.label(class="form-label") }}
                                    {{ form.peso_auto_referido(class="form-select") }}
                                </div>
                            </div>
                        </div>

                        <!-- Doenças e Condições -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Doenças e Condições</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <!-- Doenças Respiratórias -->
                                    <div class="col-md-6 mb-3">
                                        <div class="form-check mb-2">
                                            {{ form.doenca_respiratoria(class="form-check-input") }}
                                            {{ form.doenca_respiratoria.label(class="form-check-label") }}
                                        </div>
                                        <div class="ms-4">
                                            {{ form.tipo_doenca_respiratoria.label(class="form-label") }}
                                            {{ form.tipo_doenca_respiratoria(class="form-select") }}
                                        </div>
                                    </div>

                                    <!-- Hábitos -->
                                    <div class="col-md-6 mb-3">
                                        <div class="form-check mb-2">
                                            {{ form.fumante(class="form-check-input") }}
                                            {{ form.fumante.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.uso_alcool(class="form-check-input") }}
                                            {{ form.uso_alcool.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.uso_outras_drogas(class="form-check-input") }}
                                            {{ form.uso_outras_drogas.label(class="form-check-label") }}
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <!-- Doenças Crônicas -->
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            {{ form.hipertensao_arterial(class="form-check-input") }}
                                            {{ form.hipertensao_arterial.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.diabetes(class="form-check-input") }}
                                            {{ form.diabetes.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.teve_avc(class="form-check-input") }}
                                            {{ form.teve_avc.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.teve_infarto(class="form-check-input") }}
                                            {{ form.teve_infarto.label(class="form-check-label") }}
                                        </div>
                                    </div>

                                    <!-- Outras Condições -->
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            {{ form.doenca_cardiaca(class="form-check-input") }}
                                            {{ form.doenca_cardiaca.label(class="form-check-label") }}
                                        </div>
                                        <div class="ms-4 mb-3">
                                            {{ form.tipo_doenca_cardiaca.label(class="form-label") }}
                                            {{ form.tipo_doenca_cardiaca(class="form-select") }}
                                        </div>
                                        
                                        <div class="form-check mb-2">
                                            {{ form.problema_rins(class="form-check-input") }}
                                            {{ form.problema_rins.label(class="form-check-label") }}
                                        </div>
                                        <div class="ms-4">
                                            {{ form.tipo_problema_rins.label(class="form-label") }}
                                            {{ form.tipo_problema_rins(class="form-select") }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Outras Condições de Saúde -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Outras Condições de Saúde</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            {{ form.hanseniase(class="form-check-input") }}
                                            {{ form.hanseniase.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.tuberculose(class="form-check-input") }}
                                            {{ form.tuberculose.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.cancer(class="form-check-input") }}
                                            {{ form.cancer.label(class="form-check-label") }}
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            {{ form.internacao_12_meses(class="form-check-input") }}
                                            {{ form.internacao_12_meses.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.problema_saude_mental(class="form-check-input") }}
                                            {{ form.problema_saude_mental.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.acamado(class="form-check-input") }}
                                            {{ form.acamado.label(class="form-check-label") }}
                                        </div>
                                        <div class="form-check mb-2">
                                            {{ form.domiciliado(class="form-check-input") }}
                                            {{ form.domiciliado.label(class="form-check-label") }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Práticas Integrativas -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Práticas Integrativas</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            {{ form.plantas_medicinais(class="form-check-input") }}
                                            {{ form.plantas_medicinais.label(class="form-check-label") }}
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-check mb-2">
                                            {{ form.praticas_integrativas(class="form-check-input") }}
                                            {{ form.praticas_integrativas.label(class="form-check-label") }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Outras Condições -->
                        <div class="card mb-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">Observações Adicionais</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    {{ form.outras_condicoes.label(class="form-label") }}
                                    {{ form.outras_condicoes(class="form-control", rows="3") }}
                                </div>
                            </div>
                        </div>

                        <!-- Botões -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="{{ url_for('citizen.view', cidadao_id=cidadao_id) }}" class="btn btn-secondary me-md-2">
                                <i class="fas fa-times me-1"></i>Cancelar
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-1"></i>Salvar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
// Script para mostrar/ocultar campos dependientes
document.addEventListener('DOMContentLoaded', function() {
    const toggleDependentField = (checkboxId, dependentId) => {
        const checkbox = document.getElementById(checkboxId);
        const dependent = document.getElementById(dependentId);
        if (checkbox && dependent) {
            dependent.style.display = checkbox.checked ? 'block' : 'none';
        }
    };

    // Lista de pares checkbox-dependiente
    const dependencies = [
        ['gestante', 'maternidade_referencia'],
        ['doenca_respiratoria', 'tipo_doenca_respiratoria'],
        ['doenca_cardiaca', 'tipo_doenca_cardiaca'],
        ['problema_rins', 'tipo_problema_rins']
    ];

    // Configurar los event listeners
    dependencies.forEach(([checkboxId, dependentId]) => {
        const checkbox = document.getElementById(checkboxId);
        if (checkbox) {
            checkbox.addEventListener('change', () => toggleDependentField(checkboxId, dependentId));
            toggleDependentField(checkboxId, dependentId); // Estado inicial
        }
    });
});
</script>
{% endblock %}
{% endblock %} 